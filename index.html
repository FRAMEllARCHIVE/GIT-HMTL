<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GITHUB</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #1e1e1e;
        color: #ffffff;
    }

    .container {
        max-width: 500px;
        margin: 50px auto;
        padding: 20px;
        background-color: #1e1e1e;
    }

        .svg-container {
            display: flex;
            justify-content: center;
            margin: 20px;
            cursor: pointer;
        }

        svg {
            width: 100px;
            height: 100px;
            opacity: 0.1;
        }

    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
        color: #ffffff;
    }

    .form-group input,
    .form-group select {
        padding: 10px;
        margin-top: 5px;
        background-color: #333333;
        color: #ffffff;
        border: 1px solid #444;
        border-radius: 5px;
        transition: border-color 0.3s;
    }

    .form-group input:focus,
    .form-group select:focus {
        border-color: #28a745;
        outline: none;
    }

    .btn {

        display: inline-block;
        padding: 10px 10px;
        background-color: #28a745;
        color: white;
        text-align: center;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        transition: background-color 0.3s;
    }

    .btn:hover {
        background-color: #218838;
    }

    .btn-delete {
        background-color: #dc3545;
    }

    .btn-delete:hover {
        background-color: #c82333;
    }

    .repo-list {
        list-style-type: none;
        padding: 0;
    }

    .repo-list li {
        padding: 15px;
        background-color: #2b2b2b;
        margin-bottom: 10px;
        border: 1px solid #444;
        border-radius: 5px;
    }

    .file-list {
        margin-top: 10px;
        list-style-type: none;
        padding: 0;
    }

    .file-list li {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        background-color: #3c3c3c;
        margin: 5px 0;
        border: 1px solid #555;
        border-radius: 5px;
    }

    .file-list .delete-btn {
        cursor: pointer;
        color: #dc3545;
        transition: color 0.3s;
        margin-right: 11px;
    }

    .file-list .delete-btn:hover {
        color: #c82333;
    }

        #upload-file {
            background-color: #007bff;
            color: #fff;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 22px;
        }

        #upload-file:hover {
            background-color: #0069d9;
        }

        #create-repo {
            background-color: #007bff;
            color: #fff;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 22px;
        }

        #create-repo:hover {
            background-color: #0069d9;
        }

.hidden {
    display: none;
}

.visible {
    display: block;
}

#account-form {
    margin-top: 20px;
    background-color: #3a3a3a;
    padding: 15px;
    border-radius: 8px;
    max-width: 80%;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
}

#account-form-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 999;
    display: none;
}

</style>

</head>
<body>

<div class="container">

    <div class="svg-container" id="github-icon">
    <svg width="1024" height="1024" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill="white" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)" fill="#1B1F23"/>
    </svg>
    </div>


<div id="account-form-background"></div>
<div id="account-form" class="hidden">
       <div class="form-group">
            <label for="saved-accounts">Accounts</label>
            <select id="saved-accounts">
                <option value="">New Account</option>
            </select>
        </div>
    <div class="form-group">
        <label for="github-username">Username</label>
        <input type="text" id="github-username" placeholder="Enter GitHub username">
    </div>
    <div class="form-group">
        <label for="github-token">Access Token</label>
        <input type="text" id="github-token" placeholder="Enter GitHub token">
    </div>
    <button class="btn" id="save-account">SAVE</button>
</div>



    <div class="form-group">
        <label for="repo-name">REPO</label>
        <input type="text" id="repo-name" placeholder="Enter repository name">
<br/>
        <button class="btn btn-block" id="create-repo">CREATE</button>
    </div>

<div class="form-group">
    <label for="file-upload">FILE</label>
    <input type="file" id="file-upload" />
<br/>
    <button id="upload-file">UPLOAD</button>
</div>


    <hr>

    <h2>Repositories</h2>
    <ul class="repo-list" id="repo-list"></ul>
</div>

<script>

document.getElementById('account-form-background').addEventListener('click', () => {
    toggleAccountForm();
});


function getStoredAccount() {
    const selectElement = document.getElementById('saved-accounts');
    const selectedUsername = selectElement.value;

    if (!selectedUsername) {
        return { username: '', token: '' };
    }

    const token = localStorage.getItem(`github-${selectedUsername}`);

    return {
        username: selectedUsername,
        token: token
    };
}

window.addEventListener('load', () => {
    const accounts = loadSavedAccounts();
    if (accounts.length > 0) {
        const firstAccount = accounts[0];
        document.getElementById('saved-accounts').value = firstAccount;
        populateAccountForm(firstAccount);
        fetchRepositories();
    }
});

function saveAccountDetails(username, token) {
    if (username && token) {
        localStorage.setItem(`github-${username}`, token);
    }
}

function loadSavedAccounts() {
    const selectElement = document.getElementById('saved-accounts');
    selectElement.innerHTML = '<option value="">New Account</option>';
    const accounts = [];

    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('github-')) {
            const username = key.replace('github-', '');
            selectElement.innerHTML += `<option value="${username}">${username}</option>`;
            accounts.push(username);
        }
    }
    return accounts;
}

document.getElementById('save-account').addEventListener('click', () => {
    const username = document.getElementById('github-username').value;
    const token = document.getElementById('github-token').value;

    if (username && token) {
        saveAccountDetails(username, token);
        alert('Account saved successfully!');
        toggleAccountForm();
        setTimeout(fetchRepositories, 100);
    } else {
        alert('Please enter both GitHub username and token.');
    }
});



function populateAccountForm(username) {
    document.getElementById('github-username').value = username;
    document.getElementById('github-token').value = localStorage.getItem(`github-${username}`);
    console.log('Populated form with:', username, 'Token:', localStorage.getItem(`github-${username}`));
}

const selectElement = document.getElementById('saved-accounts');
selectElement.addEventListener('change', () => {
    const selectedUsername = selectElement.value;

    if (selectedUsername) {
        populateAccountForm(selectedUsername);
        fetchRepositories();
    } else {
        // Clear the inputs for Username and Access Token when "New Account" is selected
        document.getElementById('github-username').value = ""; // Clear the username input
        document.getElementById('github-token').value = "";    // Clear the token input
    }
});



function toggleAccountForm() {
    const accountForm = document.getElementById('account-form');
    const background = document.getElementById('account-form-background');

    accountForm.classList.toggle('hidden');
    
    if (accountForm.classList.contains('hidden')) {
        background.style.display = 'none';
    } else {
        background.style.display = 'block';
    }
}

document.getElementById('github-icon').addEventListener('click', () => {
    toggleAccountForm();
});

async function fetchRepositories() {
    const { username, token } = getStoredAccount();
console.log('Fetching repositories for:', { username, token });

    if (!username || !token) {
        alert('GitHub account is not set. Please enter your details.');
        return;
    }

    const response = await fetch(`https://api.github.com/users/${username}/repos`, {
        method: 'GET',
        headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json'
        }
    });

    if (response.ok) {
        const repos = await response.json();
        const repoList = document.getElementById('repo-list');
        repoList.innerHTML = '';

        repos.forEach(repo => {
            const listItem = document.createElement('li');
            listItem.textContent = repo.name;

            const githubPageLink = document.createElement('a');
            githubPageLink.href = `https://${username}.github.io/${repo.name}`;
            githubPageLink.target = '_blank';
            githubPageLink.style.marginLeft = '10px';

            const linkIcon = document.createElement('i');
            linkIcon.className = 'fas fa-link';
            linkIcon.style.fontSize = '16px';
            linkIcon.style.color = '#ffffff';
            linkIcon.style.opacity = '0.4';

            githubPageLink.appendChild(linkIcon);
            listItem.appendChild(githubPageLink);

            const fileList = document.createElement('ul');
            fileList.className = 'file-list';
            listItem.appendChild(fileList);

            fetchRepoContents(repo.name, fileList);
            repoList.appendChild(listItem);
        });
    } else {
        console.error('Error fetching repositories:', response.status, response.statusText);
    }
}

async function fetchRepoContents(repoName, fileList) {
    const { username, token } = getStoredAccount();

    const response = await fetch(`https://api.github.com/repos/${username}/${repoName}/contents`, {
        method: 'GET',
        headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json'
        }
    });

    if (response.ok) {
        const contents = await response.json();
        contents.forEach(file => {
            const fileItem = document.createElement('li');
            fileItem.textContent = file.name;

            const deleteButton = document.createElement('span');
            deleteButton.textContent = 'x';
            deleteButton.className = 'delete-btn';
            deleteButton.onclick = () => deleteFile(repoName, file.path, fileItem);

            fileItem.appendChild(deleteButton);
            fileList.appendChild(fileItem);
        });
    } else {
        console.error('Error fetching repository contents:', response.status, response.statusText);
    }
}

async function createRepository(repoName) {
    const { token } = getStoredAccount();

    const response = await fetch(`https://api.github.com/user/repos`, {
        method: 'POST',
        headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json',
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            name: repoName,
            private: false,
            auto_init: true,
        })
    });

    if (response.ok) {
        await configureGitHubPages(repoName);
        fetchRepositories();
    } else {
        console.error('Error creating repository:', response.status, response.statusText);
    }
}

async function configureGitHubPages(repoName) {
    const { username, token } = getStoredAccount();

    const response = await fetch(`https://api.github.com/repos/${username}/${repoName}/pages`, {
        method: 'POST',
        headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json',
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            source: {
                branch: "main",
                path: "/"
            }
        })
    });

    if (response.ok) {
        console.log('GitHub Pages configured');
    } else {
        console.error('Error configuring GitHub Pages:', response.status, response.statusText);
    }
}

document.getElementById('upload-file').addEventListener('click', async function () {
    const fileInput = document.getElementById('file-upload');
    const file = fileInput.files[0];
    const repoName = document.getElementById('repo-name').value;

    if (file && repoName) {
        console.log('Uploading file:', file.name);
        await uploadFile(repoName, file, file.name);
    } else {
        alert('Please select a file and enter a repository name.');
    }
});

async function uploadFile(repoName, file, fileName) {
    const { username, token } = getStoredAccount();

    const reader = new FileReader();
    reader.onload = async function (e) {
        const arrayBuffer = e.target.result;
        const uint8Array = new Uint8Array(arrayBuffer);

        let base64Content = '';
        for (let i = 0; i < uint8Array.length; i++) {
            base64Content += String.fromCharCode(uint8Array[i]);
        }
        base64Content = btoa(base64Content);

        const response = await fetch(`https://api.github.com/repos/${username}/${repoName}/contents/${fileName}`, {
            method: 'PUT',
            headers: {
                'Authorization': `token ${token}`,
                'Accept': 'application/vnd.github.v3+json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                message: `Upload ${fileName}`,
                content: base64Content,
                branch: "main"
            })
        });

        if (response.ok) {
            console.log('File uploaded');
            fetchRepositories();
        } else {
            console.error('Error uploading file:', response.status, response.statusText);
        }
    };

    reader.readAsArrayBuffer(file);
}

async function deleteFile(repoName, filePath, fileItem) {
    const { username, token } = getStoredAccount();

    const response = await fetch(`https://api.github.com/repos/${username}/${repoName}/contents/${filePath}`, {
        method: 'DELETE',
        headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json',
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            message: "Delete file",
            sha: await getFileSha(repoName, filePath)
        })
    });

    if (response.ok) {
        fileItem.remove();
        console.log(`Deleted file: ${filePath}`);
    } else {
        console.error('Error deleting file:', response.status, response.statusText);
    }
}

async function getFileSha(repoName, filePath) {
    const { username, token } = getStoredAccount();

    const response = await fetch(`https://api.github.com/repos/${username}/${repoName}/contents/${filePath}`, {
        method: 'GET',
        headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json'
        }
    });

    if (response.ok) {
        const fileData = await response.json();
        return fileData.sha;
    } else {
        console.error('Error fetching file SHA:', response.status, response.statusText);
    }
}

document.getElementById('create-repo').addEventListener('click', async function () {
    const repoName = document.getElementById('repo-name').value;
    if (repoName) {
        await createRepository(repoName);
    } else {
        alert('Please enter a repository name.');
    }
});

</script>

</body>
</html>
